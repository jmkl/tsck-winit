use serde::{Deserialize, Serialize};
use windows::Win32::UI::WindowsAndMessaging::*;

#[repr(u32)]
#[derive(Clone, Copy, PartialEq, Eq, Debug, Serialize, Deserialize)]
pub enum WinEvent {
    AiaEnd = EVENT_AIA_END,
    AiaStart = EVENT_AIA_START,
    ConsoleCaret = EVENT_CONSOLE_CARET,
    ConsoleEnd = EVENT_CONSOLE_END,
    ConsoleEndApplication = EVENT_CONSOLE_END_APPLICATION,
    ConsoleLayout = EVENT_CONSOLE_LAYOUT,
    ConsoleStartApplication = EVENT_CONSOLE_START_APPLICATION,
    ConsoleUpdateRegion = EVENT_CONSOLE_UPDATE_REGION,
    ConsoleUpdateScroll = EVENT_CONSOLE_UPDATE_SCROLL,
    ConsoleUpdateSimple = EVENT_CONSOLE_UPDATE_SIMPLE,
    ObjectAcceleratorChange = EVENT_OBJECT_ACCELERATORCHANGE,
    ObjectCloaked = EVENT_OBJECT_CLOAKED,
    ObjectContentScrolled = EVENT_OBJECT_CONTENTSCROLLED,
    ObjectCreate = EVENT_OBJECT_CREATE,
    ObjectDefActionChange = EVENT_OBJECT_DEFACTIONCHANGE,
    ObjectDescriptionChange = EVENT_OBJECT_DESCRIPTIONCHANGE,
    ObjectDestroy = EVENT_OBJECT_DESTROY,
    ObjectDragCancel = EVENT_OBJECT_DRAGCANCEL,
    ObjectDragComplete = EVENT_OBJECT_DRAGCOMPLETE,
    ObjectDragDropped = EVENT_OBJECT_DRAGDROPPED,
    ObjectDragEnter = EVENT_OBJECT_DRAGENTER,
    ObjectDragLeave = EVENT_OBJECT_DRAGLEAVE,
    ObjectDragStart = EVENT_OBJECT_DRAGSTART,
    ObjectEnd = EVENT_OBJECT_END,
    ObjectFocus = EVENT_OBJECT_FOCUS,
    ObjectHelpChange = EVENT_OBJECT_HELPCHANGE,
    ObjectHide = EVENT_OBJECT_HIDE,
    ObjectHostedObjectsInvalidated = EVENT_OBJECT_HOSTEDOBJECTSINVALIDATED,
    ObjectImeChange = EVENT_OBJECT_IME_CHANGE,
    ObjectImeHide = EVENT_OBJECT_IME_HIDE,
    ObjectImeShow = EVENT_OBJECT_IME_SHOW,
    ObjectInvoked = EVENT_OBJECT_INVOKED,
    ObjectLiveRegionChanged = EVENT_OBJECT_LIVEREGIONCHANGED,
    ObjectLocationChange = EVENT_OBJECT_LOCATIONCHANGE,
    ObjectNameChange = EVENT_OBJECT_NAMECHANGE,
    ObjectParentChange = EVENT_OBJECT_PARENTCHANGE,
    ObjectReorder = EVENT_OBJECT_REORDER,
    ObjectSelection = EVENT_OBJECT_SELECTION,
    ObjectSelectionAdd = EVENT_OBJECT_SELECTIONADD,
    ObjectSelectionRemove = EVENT_OBJECT_SELECTIONREMOVE,
    ObjectSelectionWithin = EVENT_OBJECT_SELECTIONWITHIN,
    ObjectShow = EVENT_OBJECT_SHOW,
    ObjectStateChange = EVENT_OBJECT_STATECHANGE,
    ObjectTextEditConversionTargetChanged = EVENT_OBJECT_TEXTEDIT_CONVERSIONTARGETCHANGED,
    ObjectTextSelectionChanged = EVENT_OBJECT_TEXTSELECTIONCHANGED,
    ObjectUncloaked = EVENT_OBJECT_UNCLOAKED,
    ObjectValueChange = EVENT_OBJECT_VALUECHANGE,
    OemDefinedEnd = EVENT_OEM_DEFINED_END,
    OemDefinedStart = EVENT_OEM_DEFINED_START,
    SystemAlert = EVENT_SYSTEM_ALERT,
    SystemArrangementPreview = EVENT_SYSTEM_ARRANGMENTPREVIEW,
    SystemCaptureEnd = EVENT_SYSTEM_CAPTUREEND,
    SystemCaptureStart = EVENT_SYSTEM_CAPTURESTART,
    SystemContextHelpEnd = EVENT_SYSTEM_CONTEXTHELPEND,
    SystemContextHelpStart = EVENT_SYSTEM_CONTEXTHELPSTART,
    SystemDesktopSwitch = EVENT_SYSTEM_DESKTOPSWITCH,
    SystemDialogEnd = EVENT_SYSTEM_DIALOGEND,
    SystemDialogStart = EVENT_SYSTEM_DIALOGSTART,
    SystemDragDropEnd = EVENT_SYSTEM_DRAGDROPEND,
    SystemDragDropStart = EVENT_SYSTEM_DRAGDROPSTART,
    SystemEnd = EVENT_SYSTEM_END,
    SystemForeground = EVENT_SYSTEM_FOREGROUND,
    SystemImeKeyNotification = EVENT_SYSTEM_IME_KEY_NOTIFICATION,
    SystemMenuEnd = EVENT_SYSTEM_MENUEND,
    SystemMenuPopupEnd = EVENT_SYSTEM_MENUPOPUPEND,
    SystemMenuPopupStart = EVENT_SYSTEM_MENUPOPUPSTART,
    SystemMenuStart = EVENT_SYSTEM_MENUSTART,
    SystemMinimizeEnd = EVENT_SYSTEM_MINIMIZEEND,
    SystemMinimizeStart = EVENT_SYSTEM_MINIMIZESTART,
    SystemMoveSizeEnd = EVENT_SYSTEM_MOVESIZEEND,
    SystemMoveSizeStart = EVENT_SYSTEM_MOVESIZESTART,
    SystemScrollingEnd = EVENT_SYSTEM_SCROLLINGEND,
    SystemScrollingStart = EVENT_SYSTEM_SCROLLINGSTART,
    SystemSound = EVENT_SYSTEM_SOUND,
    SystemSwitchEnd = EVENT_SYSTEM_SWITCHEND,
    SystemSwitchStart = EVENT_SYSTEM_SWITCHSTART,
    SystemSwitcherAppDropped = EVENT_SYSTEM_SWITCHER_APPDROPPED,
    SystemSwitcherAppGrabbed = EVENT_SYSTEM_SWITCHER_APPGRABBED,
    SystemSwitcherAppOverTarget = EVENT_SYSTEM_SWITCHER_APPOVERTARGET,
    SystemSwitcherCancelled = EVENT_SYSTEM_SWITCHER_CANCELLED,
    UiaEventIdSEnd = EVENT_UIA_EVENTID_END,
    UiaEventIdStart = EVENT_UIA_EVENTID_START,
    UiaPropIdSEnd = EVENT_UIA_PROPID_END,
    UiaPropIdStart = EVENT_UIA_PROPID_START,
}
impl std::fmt::Display for WinEvent {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        let str = match self {
            WinEvent::AiaEnd => "WinEvent::AiaEnd",
            WinEvent::AiaStart => "WinEvent::AiaStart",
            WinEvent::ConsoleCaret => "WinEvent::ConsoleCaret",
            WinEvent::ConsoleEnd => "WinEvent::ConsoleEnd",
            WinEvent::ConsoleEndApplication => "WinEvent::ConsoleEndApplication",
            WinEvent::ConsoleLayout => "WinEvent::ConsoleLayout",
            WinEvent::ConsoleStartApplication => "WinEvent::ConsoleStartApplication",
            WinEvent::ConsoleUpdateRegion => "WinEvent::ConsoleUpdateRegion",
            WinEvent::ConsoleUpdateScroll => "WinEvent::ConsoleUpdateScroll",
            WinEvent::ConsoleUpdateSimple => "WinEvent::ConsoleUpdateSimple",
            WinEvent::ObjectAcceleratorChange => "WinEvent::ObjectAcceleratorChange",
            WinEvent::ObjectCloaked => "WinEvent::ObjectCloaked",
            WinEvent::ObjectContentScrolled => "WinEvent::ObjectContentScrolled",
            WinEvent::ObjectCreate => "WinEvent::ObjectCreate",
            WinEvent::ObjectDefActionChange => "WinEvent::ObjectDefActionChange",
            WinEvent::ObjectDescriptionChange => "WinEvent::ObjectDescriptionChange",
            WinEvent::ObjectDestroy => "WinEvent::ObjectDestroy",
            WinEvent::ObjectDragCancel => "WinEvent::ObjectDragCancel",
            WinEvent::ObjectDragComplete => "WinEvent::ObjectDragComplete",
            WinEvent::ObjectDragDropped => "WinEvent::ObjectDragDropped",
            WinEvent::ObjectDragEnter => "WinEvent::ObjectDragEnter",
            WinEvent::ObjectDragLeave => "WinEvent::ObjectDragLeave",
            WinEvent::ObjectDragStart => "WinEvent::ObjectDragStart",
            WinEvent::ObjectEnd => "WinEvent::ObjectEnd",
            WinEvent::ObjectFocus => "WinEvent::ObjectFocus",
            WinEvent::ObjectHelpChange => "WinEvent::ObjectHelpChange",
            WinEvent::ObjectHide => "WinEvent::ObjectHide",
            WinEvent::ObjectHostedObjectsInvalidated => "WinEvent::ObjectHostedObjectsInvalidated",
            WinEvent::ObjectImeChange => "WinEvent::ObjectImeChange",
            WinEvent::ObjectImeHide => "WinEvent::ObjectImeHide",
            WinEvent::ObjectImeShow => "WinEvent::ObjectImeShow",
            WinEvent::ObjectInvoked => "WinEvent::ObjectInvoked",
            WinEvent::ObjectLiveRegionChanged => "WinEvent::ObjectLiveRegionChanged",
            WinEvent::ObjectLocationChange => "WinEvent::ObjectLocationChange",
            WinEvent::ObjectNameChange => "WinEvent::ObjectNameChange",
            WinEvent::ObjectParentChange => "WinEvent::ObjectParentChange",
            WinEvent::ObjectReorder => "WinEvent::ObjectReorder",
            WinEvent::ObjectSelection => "WinEvent::ObjectSelection",
            WinEvent::ObjectSelectionAdd => "WinEvent::ObjectSelectionAdd",
            WinEvent::ObjectSelectionRemove => "WinEvent::ObjectSelectionRemove",
            WinEvent::ObjectSelectionWithin => "WinEvent::ObjectSelectionWithin",
            WinEvent::ObjectShow => "WinEvent::ObjectShow",
            WinEvent::ObjectStateChange => "WinEvent::ObjectStateChange",
            WinEvent::ObjectTextEditConversionTargetChanged => {
                "WinEvent::ObjectTextEditConversionTargetChanged"
            }
            WinEvent::ObjectTextSelectionChanged => "WinEvent::ObjectTextSelectionChanged",
            WinEvent::ObjectUncloaked => "WinEvent::ObjectUncloaked",
            WinEvent::ObjectValueChange => "WinEvent::ObjectValueChange",
            WinEvent::OemDefinedEnd => "WinEvent::OemDefinedEnd",
            WinEvent::OemDefinedStart => "WinEvent::OemDefinedStart",
            WinEvent::SystemAlert => "WinEvent::SystemAlert",
            WinEvent::SystemArrangementPreview => "WinEvent::SystemArrangementPreview",
            WinEvent::SystemCaptureEnd => "WinEvent::SystemCaptureEnd",
            WinEvent::SystemCaptureStart => "WinEvent::SystemCaptureStart",
            WinEvent::SystemContextHelpEnd => "WinEvent::SystemContextHelpEnd",
            WinEvent::SystemContextHelpStart => "WinEvent::SystemContextHelpStart",
            WinEvent::SystemDesktopSwitch => "WinEvent::SystemDesktopSwitch",
            WinEvent::SystemDialogEnd => "WinEvent::SystemDialogEnd",
            WinEvent::SystemDialogStart => "WinEvent::SystemDialogStart",
            WinEvent::SystemDragDropEnd => "WinEvent::SystemDragDropEnd",
            WinEvent::SystemDragDropStart => "WinEvent::SystemDragDropStart",
            WinEvent::SystemEnd => "WinEvent::SystemEnd",
            WinEvent::SystemForeground => "WinEvent::SystemForeground",
            WinEvent::SystemImeKeyNotification => "WinEvent::SystemImeKeyNotification",
            WinEvent::SystemMenuEnd => "WinEvent::SystemMenuEnd",
            WinEvent::SystemMenuPopupEnd => "WinEvent::SystemMenuPopupEnd",
            WinEvent::SystemMenuPopupStart => "WinEvent::SystemMenuPopupStart",
            WinEvent::SystemMenuStart => "WinEvent::SystemMenuStart",
            WinEvent::SystemMinimizeEnd => "WinEvent::SystemMinimizeEnd",
            WinEvent::SystemMinimizeStart => "WinEvent::SystemMinimizeStart",
            WinEvent::SystemMoveSizeEnd => "WinEvent::SystemMoveSizeEnd",
            WinEvent::SystemMoveSizeStart => "WinEvent::SystemMoveSizeStart",
            WinEvent::SystemScrollingEnd => "WinEvent::SystemScrollingEnd",
            WinEvent::SystemScrollingStart => "WinEvent::SystemScrollingStart",
            WinEvent::SystemSound => "WinEvent::SystemSound",
            WinEvent::SystemSwitchEnd => "WinEvent::SystemSwitchEnd",
            WinEvent::SystemSwitchStart => "WinEvent::SystemSwitchStart",
            WinEvent::SystemSwitcherAppDropped => "WinEvent::SystemSwitcherAppDropped",
            WinEvent::SystemSwitcherAppGrabbed => "WinEvent::SystemSwitcherAppGrabbed",
            WinEvent::SystemSwitcherAppOverTarget => "WinEvent::SystemSwitcherAppOverTarget",
            WinEvent::SystemSwitcherCancelled => "WinEvent::SystemSwitcherCancelled",
            WinEvent::UiaEventIdSEnd => "WinEvent::UiaEventIdSEnd",
            WinEvent::UiaEventIdStart => "WinEvent::UiaEventIdStart",
            WinEvent::UiaPropIdSEnd => "WinEvent::UiaPropIdSEnd",
            WinEvent::UiaPropIdStart => "WinEvent::UiaPropIdStart",
        };
        write!(f, "{str}")
    }
}

impl TryFrom<u32> for WinEvent {
    type Error = ();

    fn try_from(value: u32) -> Result<Self, Self::Error> {
        match value {
            EVENT_AIA_END => Ok(Self::AiaEnd),
            EVENT_AIA_START => Ok(Self::AiaStart),
            EVENT_CONSOLE_CARET => Ok(Self::ConsoleCaret),
            EVENT_CONSOLE_END => Ok(Self::ConsoleEnd),
            EVENT_CONSOLE_END_APPLICATION => Ok(Self::ConsoleEndApplication),
            EVENT_CONSOLE_LAYOUT => Ok(Self::ConsoleLayout),
            EVENT_CONSOLE_START_APPLICATION => Ok(Self::ConsoleStartApplication),
            EVENT_CONSOLE_UPDATE_REGION => Ok(Self::ConsoleUpdateRegion),
            EVENT_CONSOLE_UPDATE_SCROLL => Ok(Self::ConsoleUpdateScroll),
            EVENT_CONSOLE_UPDATE_SIMPLE => Ok(Self::ConsoleUpdateSimple),
            EVENT_OBJECT_ACCELERATORCHANGE => Ok(Self::ObjectAcceleratorChange),
            EVENT_OBJECT_CLOAKED => Ok(Self::ObjectCloaked),
            EVENT_OBJECT_CONTENTSCROLLED => Ok(Self::ObjectContentScrolled),
            EVENT_OBJECT_CREATE => Ok(Self::ObjectCreate),
            EVENT_OBJECT_DEFACTIONCHANGE => Ok(Self::ObjectDefActionChange),
            EVENT_OBJECT_DESCRIPTIONCHANGE => Ok(Self::ObjectDescriptionChange),
            EVENT_OBJECT_DESTROY => Ok(Self::ObjectDestroy),
            EVENT_OBJECT_DRAGCANCEL => Ok(Self::ObjectDragCancel),
            EVENT_OBJECT_DRAGCOMPLETE => Ok(Self::ObjectDragComplete),
            EVENT_OBJECT_DRAGDROPPED => Ok(Self::ObjectDragDropped),
            EVENT_OBJECT_DRAGENTER => Ok(Self::ObjectDragEnter),
            EVENT_OBJECT_DRAGLEAVE => Ok(Self::ObjectDragLeave),
            EVENT_OBJECT_DRAGSTART => Ok(Self::ObjectDragStart),
            EVENT_OBJECT_END => Ok(Self::ObjectEnd),
            EVENT_OBJECT_FOCUS => Ok(Self::ObjectFocus),
            EVENT_OBJECT_HELPCHANGE => Ok(Self::ObjectHelpChange),
            EVENT_OBJECT_HIDE => Ok(Self::ObjectHide),
            EVENT_OBJECT_HOSTEDOBJECTSINVALIDATED => Ok(Self::ObjectHostedObjectsInvalidated),
            EVENT_OBJECT_IME_CHANGE => Ok(Self::ObjectImeChange),
            EVENT_OBJECT_IME_HIDE => Ok(Self::ObjectImeHide),
            EVENT_OBJECT_IME_SHOW => Ok(Self::ObjectImeShow),
            EVENT_OBJECT_INVOKED => Ok(Self::ObjectInvoked),
            EVENT_OBJECT_LIVEREGIONCHANGED => Ok(Self::ObjectLiveRegionChanged),
            EVENT_OBJECT_LOCATIONCHANGE => Ok(Self::ObjectLocationChange),
            EVENT_OBJECT_NAMECHANGE => Ok(Self::ObjectNameChange),
            EVENT_OBJECT_PARENTCHANGE => Ok(Self::ObjectParentChange),
            EVENT_OBJECT_REORDER => Ok(Self::ObjectReorder),
            EVENT_OBJECT_SELECTION => Ok(Self::ObjectSelection),
            EVENT_OBJECT_SELECTIONADD => Ok(Self::ObjectSelectionAdd),
            EVENT_OBJECT_SELECTIONREMOVE => Ok(Self::ObjectSelectionRemove),
            EVENT_OBJECT_SELECTIONWITHIN => Ok(Self::ObjectSelectionWithin),
            EVENT_OBJECT_SHOW => Ok(Self::ObjectShow),
            EVENT_OBJECT_STATECHANGE => Ok(Self::ObjectStateChange),
            EVENT_OBJECT_TEXTEDIT_CONVERSIONTARGETCHANGED => {
                Ok(Self::ObjectTextEditConversionTargetChanged)
            }
            EVENT_OBJECT_TEXTSELECTIONCHANGED => Ok(Self::ObjectTextSelectionChanged),
            EVENT_OBJECT_UNCLOAKED => Ok(Self::ObjectUncloaked),
            EVENT_OBJECT_VALUECHANGE => Ok(Self::ObjectValueChange),
            EVENT_OEM_DEFINED_END => Ok(Self::OemDefinedEnd),
            EVENT_OEM_DEFINED_START => Ok(Self::OemDefinedStart),
            EVENT_SYSTEM_ALERT => Ok(Self::SystemAlert),
            EVENT_SYSTEM_ARRANGMENTPREVIEW => Ok(Self::SystemArrangementPreview),
            EVENT_SYSTEM_CAPTUREEND => Ok(Self::SystemCaptureEnd),
            EVENT_SYSTEM_CAPTURESTART => Ok(Self::SystemCaptureStart),
            EVENT_SYSTEM_CONTEXTHELPEND => Ok(Self::SystemContextHelpEnd),
            EVENT_SYSTEM_CONTEXTHELPSTART => Ok(Self::SystemContextHelpStart),
            EVENT_SYSTEM_DESKTOPSWITCH => Ok(Self::SystemDesktopSwitch),
            EVENT_SYSTEM_DIALOGEND => Ok(Self::SystemDialogEnd),
            EVENT_SYSTEM_DIALOGSTART => Ok(Self::SystemDialogStart),
            EVENT_SYSTEM_DRAGDROPEND => Ok(Self::SystemDragDropEnd),
            EVENT_SYSTEM_DRAGDROPSTART => Ok(Self::SystemDragDropStart),
            EVENT_SYSTEM_END => Ok(Self::SystemEnd),
            EVENT_SYSTEM_FOREGROUND => Ok(Self::SystemForeground),
            EVENT_SYSTEM_IME_KEY_NOTIFICATION => Ok(Self::SystemImeKeyNotification),
            EVENT_SYSTEM_MENUEND => Ok(Self::SystemMenuEnd),
            EVENT_SYSTEM_MENUPOPUPEND => Ok(Self::SystemMenuPopupEnd),
            EVENT_SYSTEM_MENUPOPUPSTART => Ok(Self::SystemMenuPopupStart),
            EVENT_SYSTEM_MENUSTART => Ok(Self::SystemMenuStart),
            EVENT_SYSTEM_MINIMIZEEND => Ok(Self::SystemMinimizeEnd),
            EVENT_SYSTEM_MINIMIZESTART => Ok(Self::SystemMinimizeStart),
            EVENT_SYSTEM_MOVESIZEEND => Ok(Self::SystemMoveSizeEnd),
            EVENT_SYSTEM_MOVESIZESTART => Ok(Self::SystemMoveSizeStart),
            EVENT_SYSTEM_SCROLLINGEND => Ok(Self::SystemScrollingEnd),
            EVENT_SYSTEM_SCROLLINGSTART => Ok(Self::SystemScrollingStart),
            EVENT_SYSTEM_SOUND => Ok(Self::SystemSound),
            EVENT_SYSTEM_SWITCHEND => Ok(Self::SystemSwitchEnd),
            EVENT_SYSTEM_SWITCHER_APPDROPPED => Ok(Self::SystemSwitcherAppDropped),
            EVENT_SYSTEM_SWITCHER_APPGRABBED => Ok(Self::SystemSwitcherAppGrabbed),
            EVENT_SYSTEM_SWITCHER_APPOVERTARGET => Ok(Self::SystemSwitcherAppOverTarget),
            EVENT_SYSTEM_SWITCHER_CANCELLED => Ok(Self::SystemSwitcherCancelled),
            EVENT_SYSTEM_SWITCHSTART => Ok(Self::SystemSwitchStart),
            EVENT_UIA_EVENTID_END => Ok(Self::UiaEventIdSEnd),
            EVENT_UIA_EVENTID_START => Ok(Self::UiaEventIdStart),
            EVENT_UIA_PROPID_END => Ok(Self::UiaPropIdSEnd),
            EVENT_UIA_PROPID_START => Ok(Self::UiaPropIdStart),

            _ => Err(()),
        }
    }
}
